# VueRouter原理分析

1. VueRouter的作用
   1. 实现单页面应用(SPA)
   2. 问题1:什么东西可以称为页面?
      1. 一个html文件可以成为一个页面
   3. 问题2:什么是单页面应用?
      1. 单页面就是一个html文件,多页面就是多个html文件
      2. 单页面应用,就是当前页面显示不同的内容,是通过对DOM节点进行CRUD操作实现的,而不是通过跳转页面实现的
   4. 问题3:Vue不使用VueRouter能否实现单页面应用?
      1. 不使用VueRouter也可以实现单页面应用
   5. 注意点:
      1. 由于VueRouter官方响应Vue3的号召,目前直接下载vue-router,下载的版本默认是4.0,但是如果项目是Vue2.0的话,需要使用@符号下载3.0版本的vue-router
2. VueRouter给我们提供的东西
   1. 构造函数
      1. VueRouter,该函数构造调用之后,可以生成一个路由器对象,用于控制路由展示

   2. 全局组件

      1. router-view
         1. 该组件用于显示对应的路由组件
            1. 如果地址栏中的路由路径匹配了某个路由,那么当前组件就会显示他的路由组件
         2. 类似于占位符效果,类似slot组件
         3. **原理:其实他的原理就是通过响应式原理实现的**
            1. **效果:当路由路径发生变化的时候,页面自动显示对应的路由组件**
      2. router-link
         1. 该组件用于在页面上生成标签,引导用户跳转
         2. 什么是声明式导航?
            1. 定义:通过某些标签的形式,引导用户进行路由跳转,这类操作,叫做声明式导航
         3. 效果:默认生成一个a标签显示在页面上,引导用户跳转
            1. 其实这个跳转是一个伪跳转
         4. **原理:其实router-link在生成a标签的时候,会禁用a标签的默认行为,然后在点击事件里面使用编程式导航实现跳转**

   3. 公共对象

      1. $router对象

         1. 该对象是路由器对象,他负责控制所有的显示和切换,并提供一些操作路由的API方法
            1. 什么是编程式导航?
               1. 定义:使用js的API,控制用户的跳转,这类方式,称之为编程式导航
            2. push方法
               1. 该API可以控制浏览器跳转到指定的路由,该方法会保留上一次的历史记录,可以实现历史记录回退效果(可以回到上一个路由)
               2. **原理:其实就是window.history.pushState({},'',"/home")**
            3. replace方法
               1. 该API可以控制浏览器跳转到指定的路由,该方法不会保留上一次的历史记录,会覆盖上次的历史记录,导致无法返回到上一次的路由
               2. **原理:其实就是window.history.replaceState({},'',"/home")**

      2. $route对象

         1. 该对象是路由对象,他负责提供与当前路由相关的信息

            1. fullpath属性

               1. 该属性提供当前路由的完整地址

            2. query属性

               1. 数据类型:对象
               2. 该对象用于记录通过url链接传递过来的query参数
               3. 格式:/home?username=xiaoming

            3. params

               1. 数据类型:对象
               2. 该对象用于记录通过url链接传递过来的params参数
               3. 格式:/home/100
                  1. 该方法必须在声明路由地址的时候,添加占位符,声明属性名是什么
                     1. 路由path:"/home/:id"

            4. meta

               1. 数据类型:对象

               2. 该对象用于收集声明时候,提前配置好的meta参数(他不属于url传参)

               3. 格式: 

                  ```javascript
                   {

                              path:"/home",

                              component:Home,

                              meta:{

                                  isShow:true

                              }

                          }
                  ```

                  ​

               ​
3. 我们提供给VueRouter的东西
   1. 配置对象
      1. mode属性
         1. 该属性用于控制VueRouter的运行模式
         2. 数据类型:string
            1. **hash**
               1. **路径格式:http://localhost:8080/#/home**
               2. **他是通过URL的hash值实现的模式**
               3. **优点:**
                  1. **兼容性较好,兼容IE6+**
                  2. **hash模式,在任何路由地址下面刷新当前页面,发送给服务器的都是/地址,不会带上hash值(路由路径),所以服务器不需要做任何配置**
               4. **缺点:**
                  1. **路径中带有#号,太丑了**
                  2. **由于浏览器会将hash模式的路径当作锚点识别,所以会导致锚点功能无法使用**
               5. **原理:**
                  1. **可以通过window.location.hash="需要跳转的路径"来控制浏览器的历史记录栈进行跳转操作,可以使用浏览器的前进后退按钮**
                  2. **可以通过给window绑定hashchange事件,来监视浏览器地址中hash值的变化,从window.location身上获取到当前最新的路由地址**
            2. **history**
               1. **路径格式:http://localhost:8080/home**
               2. **他是通过HTML5的新特性history对象实现的** 
               3. **优点:**
                  1. **颜值就是正义,好看就行了**
                  2. **路径中没有#,而且使用的不是URL hash模式,所以锚点功能可以正常使用**
               4. **缺点:**
                  1. **兼容性较差,兼容IE9+**
                  2. **路径识别容易出错**
                     1. **问题:**
                        1. **history模式的路由地址是直接拼接在地址栏中的,**
                        2. **如果用户刷新页面,此时,浏览器会错误的把前端路由路径当作后端路径路径识别**
                        3. **从而发送请求给服务器,请求该路由**
                        4. **但是如果服务器没有该路由接口,就会返回404,导致项目无法展示**
                     2. **解决:(项目上线之前需要做的事情)**
                        1. **如果用户刷新页面,此时,浏览器会错误的把前端路由路径当作后端路径路径识别**
                        2. **从而发送请求给服务器,请求该路由,例如:"/about"**
                        3. **后端此时需要做的事情,就是将自己没有的接口统一返回index.html文件**
                        4. **浏览器接收到index.html文件,会再次请求index.js文件**
                        5. **index.js文件中的VueRouter代码会自动执行,识别当前地址栏中的前端路由**
                        6. **最终展示出对应的路由组件**
               5. **原理:**
                  1. **可以通过window.history.pushState({},'',"/home"),控制浏览器历史记录栈的变化,也可以使用浏览器的前进后退按钮**
                  2. **通过给window绑定popstate事件,可以监视到用户前进后退历史记录栈的功能,但是无法监视到pushState和replaceState操作导致的前进效果**
      2. routes属性
         1. 该属性用于存储收集所有的路由对象
         2. 数据类型:routeObj[ ]
            1. routeObj对象
               1. 如果地址栏中的路由地址与该处声明的路径相同,就显示对应的component
               2. path属性
                  1. 声明好的路由路径
               3. component属性
                  1. 声明好的路由组件