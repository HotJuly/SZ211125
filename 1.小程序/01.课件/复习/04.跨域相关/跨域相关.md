#  跨域相关

1. 问题一:什么是跨域

   1. 违反了浏览器的同源策略,就是跨域

   2. 问题:什么是同源策略

      1. 如果两个 URL 的 protocol(协议名)、port(端口号) 和 host(主机地址) 都相同的话，则这两个 URL 是同源

   3. ```javascript
      例子1:以下两个链接,协议名不相同,所以是不同源的
      	链接1:http://localhost:3000
      	链接2:ftp://localhost:3000
      	
      例子2:以下两个链接,协议名,域名,端口号都相同,而查询字符串不是判断同源的标准,所以是同源的
      	链接1:http://localhost:3000/about?username=123
      	链接2:http://localhost:3000/home
      ```

   4. 问题:为什么要有同源策略?

      1. 假设协议名不同,不会报跨域错误
         1. 请求网页使用的是http协议,而该网页使用ajax发送ftp协议的请求,获取当前电脑上的部分资料,最终发送到服务器上,会导致用户数据的丢失
      2. 假设主机地址不同,不会报跨域错误
         1. 真网站简称A网站,假网站简称B网站
         2. 浏览器请求B网站,得到html文件,并且渲染成功,B网站通过ajax发送请求,请求A网站,此时会自动携带与A网站相关的cookie数据,最终A网站将你个人的重要信息返回给浏览器,浏览器在通过ajax将这些数据发往B网站的服务器上,在这个过程中用户和A网站都受到了损失

2. 问题二:跨域一定会报错吗

   1. 不一定
   2. link/script/img/video/audio等标签可以跨域,但是不报跨域错误
   3. 服务器之间跨域请求,也不会报跨域错误
   4. **小总结:跨域是一种行为,跨域了也不一定会出现报错**

3. 问题三:什么情况下会出现跨域问题

   1. 只有在浏览器中才会出现跨域报错
   2. 只有在发送ajax请求的时候才会出现跨域报错
   3. **小总结:跨域报错其实是浏览器搞的鬼**

4. 问题四:哪些请求算是ajax请求(ajax->async javascript and xml)

   1. 简单说法:发送一个ajax请求
   2. 完整说法:通过ajax技术发送一个http请求
   3. ajax其实是一种技术,他不是一种特殊的请求类型,ajax只是一种工具
   4. **小总结:只有通过js代码发送的请求,才会出现跨域问题**

5. 跨域问题解决方案

   1. jsonp
      1. 原理:它使用了浏览器的漏洞,script标签跨域不报错
      2. 流程:
         1. 在前端网页中,准备一个接收数据的函数和变量
         2. 当用户点击按钮时,会创建一个script标签,并且添加src属性
            1. src属性的值为后端服务器的某个路由地址
            2. 注意:添加src的时候,需要将前端网页中用于接收数据的函数名称拼接上
         3. script标签具有src属性之后,就会立即请求服务器
         4. 服务器接收到请求,根据发过来的函数名称和需要返回的数据内容,拼接字符串
         5. 最终服务器将拼接的字符串作为文本内容返回给script标签
         6. script标签将得到的文本内容作为js代码,在浏览器中调用
   2. CORS(跨源资源共享)
      1. 原理:跨域报错其实是浏览器搞的鬼,所以可以让浏览器不报错
      2. 流程:
         1. 服务器在返回响应的时候,在响应头中配置属性告知浏览器即可
            1. Access-Control-Allow-Origin: "https://www.baidu.com"
   3. proxy




